# Day 10: Linux Bash Scripts ‚Äì Website Backup Automation

**Difficulty**: üü° Intermediate  
**Category**: Linux Automation / Bash Scripting  
**Estimated Time**: 30‚Äì40 minutes  

---

## üéØ Objective

Create a **Bash script** to automate the **backup of a static website** running on **App Server 1**.  
The script should compress website files, store them locally, and securely copy them to a **remote backup server** without requiring a password.

---

## üñ•Ô∏è Environment Details

| Component            | Details                          |
|----------------------|----------------------------------|
| **Organization**     | xFusionCorp Industries           |
| **Data Center**      | Stratos Datacenter               |
| **App Server**       | App Server 1 (stapp01)           |
| **Backup Server**    | Nautilus Backup Server (stbkp01) |
| **OS**               | Linux (CentOS Stream)            |
| **App Server IP**    | `172.16.xxx.xxx`                 |
| **Backup Server IP** | `172.16.xxx.xxx`                 |
| **Script Location**  | `/scripts/`                      |
| **Backup Location**  | `/backup/`                       |

---

## üìñ Scenario

The production support team needs to automate **daily website backups**.  
A static website is running under: `/var/www/html/news`

The backup must:
- Be compressed as a **zip archive**.
- Be stored locally on the app server.
- Be copied to a remote backup server.
- **Run without prompting for a password** (Passwordless SSH).
- Be executable by the application user.
- **Not use `sudo`** inside the script.

---

## üìã Prerequisites

- SSH access to both servers.
- **Passwordless SSH** configured between App Server and Backup Server.
- `zip` package installed on App Server 1.
- Backup directory `/backup` exists on both servers.

> ‚ö†Ô∏è **Note**: `zip` must be installed **manually outside the script**.

---

## üõ† Tools & Technologies

- Bash
- SSH / SCP
- zip
- Linux Filesystem

---

## üîß Implementation Steps

### Step 1: Configure Passwordless SSH (One-Time Setup)

From **App Server 1**, generate an SSH key (if not already done) and copy it to the backup server:

```bash
# Generate key (press enter for defaults)
ssh-keygen -t rsa

# Copy key to backup server
ssh-copy-id clint@172.16.xxx.xxx
```

Verify passwordless login:

```bash
ssh clint@172.16.xxx.xxx
# You should log in without a password
exit
```

### Step 2: Install zip Package (Outside Script)

The script requires `zip`, which might not be installed by default.

```bash
sudo yum install zip -y
```

### Step 3: Create the Backup Script

Navigate to the scripts directory and create the file:

```bash
cd /scripts
vi news_backup.sh
```

### Step 4: Script Content (`news_backup.sh`)

Add the following content to the script:

```bash
#!/bin/bash

# Create zip archive of website
zip -r /backup/xfusioncorp_news.zip /var/www/html/news

# Copy backup to Nautilus Backup Server
scp /backup/xfusioncorp_news.zip clint@172.16.xxx.xxx:/backup/
```

### Step 5: Make Script Executable

Ensure the script has execution permissions:

```bash
chmod +x news_backup.sh
```

### Step 6: Execute and Verify

Run the script manually to test:

```bash
./news_backup.sh
```

---

## ‚úÖ Verification

**On App Server 1:**

```bash
ls -l /backup/xfusioncorp_news.zip
```

**On Backup Server:**

```bash
ssh clint@172.16.xxx.xxx "ls -l /backup/xfusioncorp_news.zip"
```

---

## üß† Key Learnings

- **Automation**: Bash scripts can automate repetitive operational tasks like backups.
- **Compression**: `zip` is a simple tool for compressing website data across directories.
- **Security**: Passwordless SSH (Keys) is essential for unattended automation scripts.
- **Permissions**: Scripts should be executable (`chmod +x`) and generally run without `sudo` for routine tasks.

---

## üîê Best Practices

- Store scripts in a dedicated directory (e.g., `/scripts`).
- **Never hardcode passwords** in scripts; use SSH keys.
- Use variables for paths and IPs to make the script reusable.
- Test scripts manually before scheduling them with `cron`.
